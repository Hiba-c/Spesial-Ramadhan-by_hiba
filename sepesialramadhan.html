<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ramadhan 1447H - Ultimate Mode</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#0f2027;
  --secondary:#134e4a;
  --accent:#ffd369;
  --success:#4CAF50;
  --danger:#ff5252;
  --highlight:#ffeaa7;
}

body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(160deg,#0f2027,#1c3a3a,#134e4a);
  color:#fff;
  padding:20px;
}

/* HEADER */
h1{text-align:center;margin-bottom:5px;}
.subtitle{text-align:center;color:var(--accent);margin-bottom:20px;}

/* CONTAINER */
.container{
  max-width:1100px;
  margin:auto;
  background:#fff;
  color:#333;
  border-radius:20px;
  padding:20px;
  box-shadow:0 15px 60px rgba(0,0,0,0.4);
}

/* HEADER TANGGAL */
.day-header{text-align:center;margin-bottom:15px;}
.day-name{font-size:22px;font-weight:700;}
.date-info{font-size:14px;color:#555;}

/* PROGRESS */
.progress-bar{height:10px;background:#eee;border-radius:20px;overflow:hidden;margin-bottom:10px;}
.progress{height:100%;width:0%;background:var(--success);transition:0.3s;}
.stats{display:flex;justify-content:space-between;font-size:14px;margin-bottom:15px;}

/* SCHEDULE */
.entry{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:10px;margin-bottom:6px;background:#f9f9f9;transition:0.3s;}
.entry.done{opacity:0.6;text-decoration:line-through;}
.entry.highlight{background:var(--highlight);border-left:4px solid #f39c12;}
.time{width:30%;font-weight:600;}
.activity{width:55%;}
.checkbox{width:15%;text-align:right;}

/* BUTTON */
button{
  background:var(--secondary);
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
  margin-top:10px;
}

/* DONUT & HISTOGRAM */
.donut-wrapper{display:flex;justify-content:space-between;flex-wrap:wrap;margin-top:20px;}
.donut{width:220px;height:220px;border-radius:50%;background:conic-gradient(var(--success) 0deg, #e0e0e0 0deg);display:flex;align-items:center;justify-content:center;position:relative;margin-bottom:20px;}
.donut::after{content:"";width:150px;height:150px;background:#fff;border-radius:50%;position:absolute;}
.donut span{position:relative;font-weight:700;font-size:26px;}
.histogram{flex:1;margin-left:20px;}
.bar{background:#e0e0e0;height:18px;margin-bottom:8px;border-radius:10px;overflow:hidden;}
.bar-fill{height:100%;background:var(--success);text-align:right;font-size:11px;color:#fff;padding-right:5px;}

/* TABLE */
table{width:100%;border-collapse:collapse;margin-top:20px;font-size:12px;}
th,td{border:1px solid #ddd;padding:5px;text-align:center;}
th{background:#134e4a;color:#fff;}
.success{color:var(--success);font-weight:600;}
.fail{color:var(--danger);font-weight:600;}

/* RESPONSIVE */
@media(max-width:992px){
  .donut-wrapper{flex-direction:column;align-items:center;}
  .histogram{margin-left:0;width:100%;}
}

@media(max-width:600px){
  body{padding:15px;}
  .container{padding:15px;}
  .day-name{font-size:18px;}
  .progress-bar{height:8px;}
  .time,.activity,.checkbox{font-size:12px;}
  table{font-size:10px;}
  button{width:100%;}
}
</style>
</head>

<body>

<h1>ðŸ”¥ RAMADHAN 1447H</h1>
<div class="subtitle">Upgrade Hati â€¢ Upgrade Tubuh â€¢ Upgrade Otak</div>

<div class="container">

  <div class="day-header">
    <div class="day-name" id="dayName"></div>
    <div class="date-info" id="dateInfo"></div>
  </div>

  <div class="progress-bar">
    <div class="progress" id="progress"></div>
  </div>

  <div class="stats">
    <div id="progressText"></div>
    <div id="streak"></div>
  </div>

  <div>
    <strong>WORDS OF ENCOURAGEMENT</strong><br>
    Ramadhan bukan cuma nahan lapar, tapi nahan malas.<br>
    Ibadah naik, skill naik, mindset naik.<br>
    Konsisten kecil tiap hari > semangat gede tapi cuma 3 hari.<br><br>
    Fokus jadi 1% lebih baik setiap hari.
  </div>

  <br><br>
  
  <div id="schedule"></div>

  <button onclick="resetToday()">Reset Hari Ini</button>

  <hr>

  <h3>Filter Progress Berdasarkan Tanggal</h3>
  Dari: <input type="date" id="startDate">
  Sampai: <input type="date" id="endDate">
  <button onclick="searchProgress()">Cari</button>
  <button onclick="renderHistogram()">Reset</button>

  <div class="donut-wrapper">
    <div class="donut" id="donutChart">
      <span id="donutText">0%</span>
    </div>
    <div class="histogram" id="histogram"></div>
  </div>

  <div id="summaryTable"></div>
</div>

<script>
/* BASE SCHEDULE */
const baseSchedule = [
["03.00 - 03.40","Bangun, Tahajud & doa malam"],
["03.40 - 04.30","Sahur & persiapan Subuh"],
["04.30 - 05.15","Sholat Subuh, kajian & baca Al-Qur'an"],
["05.15 - 05.45","Olahraga ringan (stretching / jalan santai)"],
["05.45 - 07.00","Belajar / membaca buku pengembangan diri"],
["07.00 - 09.00","Waktu bebas / aktivitas ringan produktif"],
["09.00 - 11.30","Istirahat / tidur ringan"],
["12.00 - 12.45","Sholat Dzuhur"],
["12.45 - 13.30","Baca Al-Qur'an + dengar podcast motivasi"],
["13.30 - 14.30","Istirahat siang"],
["15.15 - 16.00","Sholat Ashar + baca Al-Qur'an"],
["16.00 - 17.00","Baca buku + membaca dokumentasi pemrograman"],
["17.00 - 18.00","Ngabuburit & persiapan buka puasa"],
["18.00 - 19.00","Buka puasa, Sholat Maghrib & makan malam"],
["19.15 - 19.45","Sholat Isya'"],
["19.45 - 20.45","Sholat Tarawih"],
["20.45 - 21.15","Baca Al-Qur'an"],
["21.15 - 22.30","Ngoding / belajar pemrograman (MINIMAL 1 JAM)"],
["22.30 - 03.00","Istirahat malam"]
];

const todayKey = new Date().toDateString();
let savedData = JSON.parse(localStorage.getItem(todayKey)) || {};
let streakData = JSON.parse(localStorage.getItem("ramadhanStreak")) || {lastDate:null,streak:0};

/* UPDATE HEADER */
function updateHeader(){
  const now=new Date();
  const days=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
  let today=days[now.getDay()];
  document.getElementById("dayName").textContent=(today==="Minggu"?"MINGGU | AHAD":today.toUpperCase());
  const masehi=now.toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});
  const hijri=new Intl.DateTimeFormat("id-TN-u-ca-islamic",{day:"2-digit",month:"long",year:"numeric"}).format(now);
  document.getElementById("dateInfo").textContent=`[ ${masehi} M | ${hijri} H ]`;
}

/* RENDER SCHEDULE */
function renderSchedule(){
  const container=document.getElementById("schedule");
  container.innerHTML="";
  const now=new Date();
  const currentMinutes=now.getHours()*60+now.getMinutes();
  let upcomingIndexes=[];
  baseSchedule.forEach((item,index)=>{
    const [hour,minute]=item[0].split(":");
    const totalMin=parseInt(hour)*60+parseInt(minute);
    if(totalMin>=currentMinutes) upcomingIndexes.push(index);
  });
  const highlightIndexes=upcomingIndexes.slice(0,2);
  baseSchedule.forEach((item,index)=>{
    const div=document.createElement("div");
    div.className="entry";
    if(savedData[index]) div.classList.add("done");
    if(highlightIndexes.includes(index)) div.classList.add("highlight");
    div.innerHTML=`
      <div class="time">${item[0]}</div>
      <div class="activity">${item[1]}</div>
      <div class="checkbox">
        <input type="checkbox" ${savedData[index]?"checked":""} onchange="toggleTask(${index})">
      </div>`;
    container.appendChild(div);
  });
  updateProgress();
}

/* STREAK */
function updateStreak(percent){
  const yesterday=new Date();
  yesterday.setDate(yesterday.getDate()-1);
  const yesterdayKey=yesterday.toDateString();
  if(percent===100){
    if(streakData.lastDate===yesterdayKey) streakData.streak+=1;
    else if(streakData.lastDate!==todayKey) streakData.streak=1;
    streakData.lastDate=todayKey;
    localStorage.setItem("ramadhanStreak",JSON.stringify(streakData));
  }
  document.getElementById("streak").textContent="ðŸ”¥ Streak: "+streakData.streak+" hari";
}

/* UPDATE PROGRESS */
function updateProgress(){
  const total=baseSchedule.length;
  const done=Object.values(savedData).filter(v=>v).length;
  const percent=Math.round((done/total)*100);
  document.getElementById("progress").style.width=percent+"%";
  document.getElementById("progressText").textContent=`${done}/${total} selesai (${percent}%)`;
  let history=JSON.parse(localStorage.getItem("progressHistory"))||{};
  history[todayKey]=percent;
  localStorage.setItem("progressHistory",JSON.stringify(history));
  updateStreak(percent);
  updateDonut();
  renderHistogram();
  updateTable();
}

function toggleTask(index){
  savedData[index]=!savedData[index];
  localStorage.setItem(todayKey,JSON.stringify(savedData));
  renderSchedule();
}

/* DONUT */
function updateDonut(){
  let history=JSON.parse(localStorage.getItem("progressHistory"))||{};
  let values=Object.values(history);
  if(values.length===0) return;
  let avg=Math.round(values.reduce((a,b)=>a+b,0)/values.length);
  document.getElementById("donutChart").style.background=`conic-gradient(#4CAF50 ${avg*3.6}deg, #e0e0e0 0deg)`;
  document.getElementById("donutText").innerText=avg+"%";
}

/* HISTOGRAM */
function renderHistogram(filteredData=null){
  const container=document.getElementById("histogram");
  container.innerHTML="<h4>Progress</h4>";
  let history=JSON.parse(localStorage.getItem("progressHistory"))||{};
  let data=filteredData || Object.entries(history).slice(-7);
  data.forEach(([date,percent])=>{
    const bar=document.createElement("div");
    bar.className="bar";
    const fill=document.createElement("div");
    fill.className="bar-fill";
    fill.style.width=percent+"%";
    fill.innerText=percent+"%";
    bar.appendChild(fill);
    container.appendChild(document.createTextNode(date));
    container.appendChild(bar);
  });
}

function searchProgress(){
  const start=new Date(document.getElementById("startDate").value);
  const end=new Date(document.getElementById("endDate").value);
  if(!start||!end) return;
  let history=JSON.parse(localStorage.getItem("progressHistory"))||{};
  let filtered=[];
  Object.entries(history).forEach(([date,percent])=>{
    let d=new Date(date);
    if(d>=start && d<=end) filtered.push([date,percent]);
  });
  renderHistogram(filtered);
}

/* TABLE */
function updateTable(){
  let html="<table><tr><th>No</th><th>Tanggal</th><th>Progress</th></tr>";
  let history=JSON.parse(localStorage.getItem("progressHistory"))||{};
  let no=1;
  Object.entries(history).forEach(([date,percent])=>{
    html+=`<tr><td>${no}</td><td>${date}</td><td>${percent}%</td></tr>`;
    no++;
  });
  html+="</table>";
  document.getElementById("summaryTable").innerHTML=html;
}

/* RESET HARI INI */
function resetToday(){
  localStorage.removeItem(todayKey);
  savedData={};
  renderSchedule();
}

/* INIT */
updateHeader();
renderSchedule();
updateDonut();
renderHistogram();
updateTable();

</script>

</body>
</html>
